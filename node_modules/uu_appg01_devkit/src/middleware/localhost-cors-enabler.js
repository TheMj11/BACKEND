"use strict";

const cors = require("cors");

const MIDDLEWARE_ORDER = -425;

/**
 * Middleware to be automatically injected to locally started uuApp server
 * configuring CORS to allow invocation of localhost commands from uuConsole.
 */
class LocalhostCorsEnabler {

  constructor() {
    this.order = MIDDLEWARE_ORDER;
    this.profiles = "test, development";
  }

  get pre() {
    let corsOptions = {
      origin: true,
      optionsSuccessStatus: 200,
      credentials: true,
      exposedHeaders: ["X-Ues-Error", "Etag", "X-Request-Id", "Www-Authenticate", "Content-Disposition"],
    };
    return [
      cors(corsOptions)
    ];
  }

}

module.exports = LocalhostCorsEnabler;

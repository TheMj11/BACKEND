"use strict";
const { UseCaseError, UseCaseContext } = require("uu_appg01_server").AppServer;
const <%= context.projectClassName %>Constants = require("../../constants/<%= context.projectClassFile %>-constants.js");

class <%= context.projectClassName %>UseCaseError extends UseCaseError {
  constructor(code, message, paramMap, cause, status = 400, dtoOut) {
    if (paramMap instanceof Error) {
      cause = paramMap;
      paramMap = {};
    }
    if (!dtoOut) {
      dtoOut = { uuAppErrorMap: UseCaseContext.getAttribute(<%= context.projectClassName %>Constants.UU_APP_ERROR_MAP) };
    }
    super({ dtoOut, paramMap, status }, cause);
    this.code = <%= context.projectClassName %>UseCaseError.generateCode(code);
    this.message = message;
  }

  /**
   * Regenerates code based on input URI.
   * This can be used in cases, when URI cannot be passed as input parameter to constructor.
   */
  static generateCode(code) {
    let uri = UseCaseContext.getUri();
    //If the URI is specified and the code does not contain any slash, generate code as <product from URI>/<useCase from URI>/code.
    return code.indexOf("/") < 0 ? `${<%= context.projectClassName %>Constants.ERROR_PREFIX}/${uri.getUseCase()}/${code}` : code;
  }
}

module.exports = <%= context.projectClassName %>UseCaseError;
